<!DOCTYPE html>
<html>
<head>
    <title>骰子模拟器</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        #dice {
            width: 80px;
            height: 80px;
            font-size: 36px;
            margin: 20px auto;
            display: grid;
            place-items: center;
            transition: transform 0.3s;
        }
        
        .chart-container {
            height: 250px;  /* 缩小图表尺寸 */
            margin: 20px 0;
        }
        
        .stats-container {
            overflow-x: auto;  /* 表格自适应 */
            margin: 20px 0;
        }
        
        table {
            width: 100%;
            max-width: 600px;  /* 表格最大宽度限制 */
            border-collapse: collapse;
            margin: 10px 0;
        }
        
        th, td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        input[type="number"] {
            width: 120px;
            padding: 5px;
            margin: 10px 0;
        }
        
        button {
            padding: 8px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button:hover {
            background: #45a049;
        }
        
        @keyframes roll {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .rolling {
            animation: roll 0.4s infinite linear;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>骰子模拟器</h2>
        <div>
            <input type="number" id="rolls" min="1" value="500" style="width: 100px">
            <button onclick="simulate()">开始投掷</button>
        </div>
        <div id="dice">🎲</div>

        <div class="stats-container">
            <h4>频数统计表</h4>
            <table id="frequencyTable">
                <tr><th>点数</th><th>次数</th><th>频率</th></tr>
            </table>
        </div>

        <div class="chart-container">
            <canvas id="myChart"></canvas>
        </div>
    </div>

    <script>
        let chart = null;
        const ctx = document.getElementById('myChart').getContext('2d');

        function updateDice(number) {
            const dice = document.getElementById('dice');
            dice.textContent = number;
            dice.classList.add('rolling');
            setTimeout(() => dice.classList.remove('rolling'), 300);
        }

        function createChart(labels, data) {
            if (chart) chart.destroy();
            
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '出现次数',
                        data: data,
                        backgroundColor: [
                            '#FF6B6B', '#4ECDC4', '#45B7D1',
                            '#96CEB4', '#FFEEAD', '#D4A5A5'
                        ],
                        barThickness: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            precision: 0,
                            ticks: { color: '#666' }
                        },
                        x: { grid: { display: false } }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });
        }

        function simulate() {
            const rolls = parseInt(document.getElementById('rolls').value);
            if (isNaN(rolls) || rolls < 1) {
                alert("请输入有效次数");
                return;
            }

            const results = Array(6).fill(0);
            const table = document.getElementById('frequencyTable');
            table.innerHTML = '<tr><th>点数</th><th>次数</th><th>频率</th></tr>';

            // 模拟投掷
            for (let i = 0; i < rolls; i++) {
                const result = Math.floor(Math.random() * 6) + 1;
                results[result - 1]++;
                updateDice(result);
            }

            // 更新表格
            results.forEach((count, index) => {
                const row = table.insertRow();
                const freq = ((count / rolls) * 100).toFixed(1);
                row.insertCell().textContent = index + 1;
                row.insertCell().textContent = count;
                row.insertCell().textContent = `${freq}%`;
            });

            // 更新图表
            createChart(['1','2','3','4','5','6'], results);
        }

        // 初始示例
        simulate(100);
    </script>
</body>
</html>